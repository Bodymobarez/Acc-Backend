â³ Attempting database connection...
ğŸš€ Server is running on port 3001
ğŸ“ Environment: production
ğŸ”— Local: http://localhost:3001
ğŸŒ Network: http://0.0.0.0:3001
â¤ï¸  Health check: http://localhost:3001/health
2025-11-19T20:58:47.285Z - GET /api/bookings
Checking permission: viewBookings
User: ceo@bdesktravel.com
User role: ADMIN
User permissions: {
  viewDashboard: true,
  viewBookings: true,
  createBooking: true,
  editBooking: true,
  deleteBooking: true,
  reviewBooking: true,
  viewCustomers: true,
  createCustomer: true,
  editCustomer: true,
  deleteCustomer: true,
  viewSuppliers: true,
  createSupplier: true,
  editSupplier: true,
  deleteSupplier: true,
  viewInvoices: true,
  createInvoice: true,
  editInvoice: true,
  deleteInvoice: true,
  generateInvoice: true,
  viewFiles: true,
  createFile: true,
  editFile: true,
  deleteFile: true,
  generateFile: true,
  viewReports: true,
  viewFinancialReports: true,
  viewCommissionReports: true,
  viewVATReports: true,
  exportReports: true,
  viewEmployees: true,
  createEmployee: true,
  editEmployee: true,
  deleteEmployee: true,
  manageCommissions: true,
  viewSettings: true,
  editSettings: true,
  manageUsers: true,
  manageCurrencies: true,
  accessAuditLogs: true,
  managePermissions: true,
}
âœ… Access granted: User has admin-level role
âœ… Database connected successfully
â„¹ï¸  Currency automatic updates DISABLED
   Updates will only occur when manually triggered via "Update Rates Online" button
2025-11-19T20:58:49.281Z - GET /api/invoices
Checking permission: viewInvoices
User: ceo@bdesktravel.com
User role: ADMIN
User permissions: {
  viewDashboard: true,
  viewBookings: true,
  createBooking: true,
  editBooking: true,
  deleteBooking: true,
  reviewBooking: true,
  viewCustomers: true,
  createCustomer: true,
  editCustomer: true,
  deleteCustomer: true,
  viewSuppliers: true,
  createSupplier: true,
  editSupplier: true,
  deleteSupplier: true,
  viewInvoices: true,
  createInvoice: true,
  editInvoice: true,
  deleteInvoice: true,
  generateInvoice: true,
  viewFiles: true,
  createFile: true,
  editFile: true,
  deleteFile: true,
  generateFile: true,
  viewReports: true,
  viewFinancialReports: true,
  viewCommissionReports: true,
  viewVATReports: true,
  exportReports: true,
  viewEmployees: true,
  createEmployee: true,
  editEmployee: true,
  deleteEmployee: true,
  manageCommissions: true,
  viewSettings: true,
  editSettings: true,
  manageUsers: true,
  manageCurrencies: true,
  accessAuditLogs: true,
  managePermissions: true,
}
âœ… Access granted: User has admin-level role

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ SAMPLE BOOKING DATA (First Record):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ID: 53b9bc6b-2819-411a-9c38-eab7b918a1d0
Booking Number: BKG-2025-000018
Status: CONFIRMED

ğŸ“„ INVOICE DATA:
  Invoices: {
  id: "800c844a-469d-4361-b1ea-dddd8e8ad310",
  invoiceNumber: "INV-2025-000018",
  status: "UNPAID",
}

ğŸ’° FINANCIAL DATA:
  Sale in AED: 425
  Cost in AED: 300
  Gross Profit: 104.76
  Net Profit: 83.81

ğŸ‘” AGENT DATA:
  Booking Agent ID: cmh94wn7r000akuf8fgm4cl34
  Booking Agent: {
  id: "cmh94wn7r000akuf8fgm4cl34",
  userId: "cmh7y4fh60005vf3kty7au9hi",
  employeeCode: "EMP-000",
  department: "MANAGEMENT",
  defaultCommissionRate: 0,
  customCommissionRates: "{}",
  isActive: true,
  createdAt: 2025-10-27T12:49:06.952Z,
  updatedAt: 2025-10-30T12:00:50.758Z,
  users: {
    id: "cmh7y4fh60005vf3kty7au9hi",
    firstName: "Yasser",
    lastName: "Mobarez",
    email: "ceo@bdesktravel.com",
  },
}
  Agent Commission Rate: 0
  Agent Commission Amount: 0

ğŸ’¼ SALES AGENT DATA:
  Customer Service ID: 24693b1a-355e-4de7-bd8f-4cf6d55d53e1
  Customer Service: {
  id: "24693b1a-355e-4de7-bd8f-4cf6d55d53e1",
  userId: "6ec4ddad-c0cb-478e-90f3-ed0365e2f5a0",
  employeeCode: "EMP-006",
  department: "Sales",
  defaultCommissionRate: 20,
  customCommissionRates: "{}",
  isActive: true,
  createdAt: 2025-10-30T13:16:56.404Z,
  updatedAt: 2025-10-30T13:16:56.404Z,
  users: {
    id: "6ec4ddad-c0cb-478e-90f3-ed0365e2f5a0",
    firstName: "Amal",
    lastName: "Elshafee",
    email: "amal@bookingdesk.travel",
  },
}
  CS Commission Rate: 20
  CS Commission Amount: 20.95
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2025-11-19T20:59:08.249Z - GET /api/bookings
Checking permission: viewBookings
User: ceo@bdesktravel.com
User role: ADMIN
User permissions: {
  viewDashboard: true,
  viewBookings: true,
  createBooking: true,
  editBooking: true,
  deleteBooking: true,
  reviewBooking: true,
  viewCustomers: true,
  createCustomer: true,
  editCustomer: true,
  deleteCustomer: true,
  viewSuppliers: true,
  createSupplier: true,
  editSupplier: true,
  deleteSupplier: true,
  viewInvoices: true,
  createInvoice: true,
  editInvoice: true,
  deleteInvoice: true,
  generateInvoice: true,
  viewFiles: true,
  createFile: true,
  editFile: true,
  deleteFile: true,
  generateFile: true,
  viewReports: true,
  viewFinancialReports: true,
  viewCommissionReports: true,
  viewVATReports: true,
  exportReports: true,
  viewEmployees: true,
  createEmployee: true,
  editEmployee: true,
  deleteEmployee: true,
  manageCommissions: true,
  viewSettings: true,
  editSettings: true,
  manageUsers: true,
  manageCurrencies: true,
  accessAuditLogs: true,
  managePermissions: true,
}
âœ… Access granted: User has admin-level role
2025-11-19T20:59:10.365Z - GET /api/invoices
Checking permission: viewInvoices
User: ceo@bdesktravel.com
User role: ADMIN
User permissions: {
  viewDashboard: true,
  viewBookings: true,
  createBooking: true,
  editBooking: true,
  deleteBooking: true,
  reviewBooking: true,
  viewCustomers: true,
  createCustomer: true,
  editCustomer: true,
  deleteCustomer: true,
  viewSuppliers: true,
  createSupplier: true,
  editSupplier: true,
  deleteSupplier: true,
  viewInvoices: true,
  createInvoice: true,
  editInvoice: true,
  deleteInvoice: true,
  generateInvoice: true,
  viewFiles: true,
  createFile: true,
  editFile: true,
  deleteFile: true,
  generateFile: true,
  viewReports: true,
  viewFinancialReports: true,
  viewCommissionReports: true,
  viewVATReports: true,
  exportReports: true,
  viewEmployees: true,
  createEmployee: true,
  editEmployee: true,
  deleteEmployee: true,
  manageCommissions: true,
  viewSettings: true,
  editSettings: true,
  manageUsers: true,
  manageCurrencies: true,
  accessAuditLogs: true,
  managePermissions: true,
}
âœ… Access granted: User has admin-level role

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ SAMPLE BOOKING DATA (First Record):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ID: 53b9bc6b-2819-411a-9c38-eab7b918a1d0
Booking Number: BKG-2025-000018
Status: CONFIRMED

ğŸ“„ INVOICE DATA:
  Invoices: {
  id: "800c844a-469d-4361-b1ea-dddd8e8ad310",
  invoiceNumber: "INV-2025-000018",
  status: "UNPAID",
}

ğŸ’° FINANCIAL DATA:
  Sale in AED: 425
  Cost in AED: 300
  Gross Profit: 104.76
  Net Profit: 83.81

ğŸ‘” AGENT DATA:
  Booking Agent ID: cmh94wn7r000akuf8fgm4cl34
  Booking Agent: {
  id: "cmh94wn7r000akuf8fgm4cl34",
  userId: "cmh7y4fh60005vf3kty7au9hi",
  employeeCode: "EMP-000",
  department: "MANAGEMENT",
  defaultCommissionRate: 0,
  customCommissionRates: "{}",
  isActive: true,
  createdAt: 2025-10-27T12:49:06.952Z,
  updatedAt: 2025-10-30T12:00:50.758Z,
  users: {
    id: "cmh7y4fh60005vf3kty7au9hi",
    firstName: "Yasser",
    lastName: "Mobarez",
    email: "ceo@bdesktravel.com",
  },
}
  Agent Commission Rate: 0
  Agent Commission Amount: 0

ğŸ’¼ SALES AGENT DATA:
  Customer Service ID: 24693b1a-355e-4de7-bd8f-4cf6d55d53e1
  Customer Service: {
  id: "24693b1a-355e-4de7-bd8f-4cf6d55d53e1",
  userId: "6ec4ddad-c0cb-478e-90f3-ed0365e2f5a0",
  employeeCode: "EMP-006",
  department: "Sales",
  defaultCommissionRate: 20,
  customCommissionRates: "{}",
  isActive: true,
  createdAt: 2025-10-30T13:16:56.404Z,
  updatedAt: 2025-10-30T13:16:56.404Z,
  users: {
    id: "6ec4ddad-c0cb-478e-90f3-ed0365e2f5a0",
    firstName: "Amal",
    lastName: "Elshafee",
    email: "amal@bookingdesk.travel",
  },
}
  CS Commission Rate: 20
  CS Commission Amount: 20.95
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2025-11-19T20:59:44.594Z - GET /api/invoices
Checking permission: viewInvoices
User: ceo@bdesktravel.com
User role: ADMIN
User permissions: {
  viewDashboard: true,
  viewBookings: true,
  createBooking: true,
  editBooking: true,
  deleteBooking: true,
  reviewBooking: true,
  viewCustomers: true,
  createCustomer: true,
  editCustomer: true,
  deleteCustomer: true,
  viewSuppliers: true,
  createSupplier: true,
  editSupplier: true,
  deleteSupplier: true,
  viewInvoices: true,
  createInvoice: true,
  editInvoice: true,
  deleteInvoice: true,
  generateInvoice: true,
  viewFiles: true,
  createFile: true,
  editFile: true,
  deleteFile: true,
  generateFile: true,
  viewReports: true,
  viewFinancialReports: true,
  viewCommissionReports: true,
  viewVATReports: true,
  exportReports: true,
  viewEmployees: true,
  createEmployee: true,
  editEmployee: true,
  deleteEmployee: true,
  manageCommissions: true,
  viewSettings: true,
  editSettings: true,
  manageUsers: true,
  manageCurrencies: true,
  accessAuditLogs: true,
  managePermissions: true,
}
âœ… Access granted: User has admin-level role
2025-11-19T20:59:50.813Z - GET /api/invoices
Checking permission: viewInvoices
User: ceo@bdesktravel.com
User role: ADMIN
User permissions: {
  viewDashboard: true,
  viewBookings: true,
  createBooking: true,
  editBooking: true,
  deleteBooking: true,
  reviewBooking: true,
  viewCustomers: true,
  createCustomer: true,
  editCustomer: true,
  deleteCustomer: true,
  viewSuppliers: true,
  createSupplier: true,
  editSupplier: true,
  deleteSupplier: true,
  viewInvoices: true,
  createInvoice: true,
  editInvoice: true,
  deleteInvoice: true,
  generateInvoice: true,
  viewFiles: true,
  createFile: true,
  editFile: true,
  deleteFile: true,
  generateFile: true,
  viewReports: true,
  viewFinancialReports: true,
  viewCommissionReports: true,
  viewVATReports: true,
  exportReports: true,
  viewEmployees: true,
  createEmployee: true,
  editEmployee: true,
  deleteEmployee: true,
  manageCommissions: true,
  viewSettings: true,
  editSettings: true,
  manageUsers: true,
  manageCurrencies: true,
  accessAuditLogs: true,
  managePermissions: true,
}
âœ… Access granted: User has admin-level role
